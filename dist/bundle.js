(()=>{"use strict";function e(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var t;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(t||(t={}));class n{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class r extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new r),this.instance}addProject(e,r,s){const i=new n(Math.random().toString(),e,r,s,t.Active);this.projects.push(i),this.updaeListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updaeListeners())}updaeListeners(){for(const e of this.listeners)e(this.projects.slice())}}const s=r.getInstance();function i(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}class l{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}class o extends l{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5},s={value:+n,required:!0,min:1,max:5};return i({value:e,required:!0})&&i(r)&&i(s)?[e,t,+n]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;s.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],o.prototype,"submitHandler",null);class a extends l{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned.",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],a.prototype,"dragStartHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends l{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const n=e.dataTransfer.getData("text/plain");s.moveProject(n,"active"===this.type?t.Active:t.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),s.addListener((e=>{const n=e.filter((e=>"active"===this.type?e.status===t.Active:e.status===t.Finished));this.assignedProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}}c([e],d.prototype,"dragOverHandler",null),c([e],d.prototype,"dropHandler",null),c([e],d.prototype,"dragLeaveHandler",null),new o,new d("active"),new d("finished"),console.log("ccc")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL3N0YXRlL3Byb2plY3Qtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL3V0aWwvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2FwcC50cyJdLCJuYW1lcyI6WyJhdXRvYmluZCIsIl8iLCJfMiIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbE1ldGhvZCIsInZhbHVlIiwiY29uZmlndXJhYmxlIiwiYmluZCIsInRoaXMiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInN0YXR1cyIsIlByb2plY3RTdGF0ZSIsImxpc3RlbmVycyIsImxpc3RlbmVyRm4iLCJwdXNoIiwic3VwZXIiLCJwcm9qZWN0cyIsImluc3RhbmNlIiwibnVtT2ZQZW9wbGUiLCJuZXdQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwiQWN0aXZlIiwidXBkYWVMaXN0ZW5lcnMiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiQ29tcG9uZW50IiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2lubmluZyIsImluc2VydEFkamFjZW50RWxlbWVudCIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwiY29uZmlndXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJlbnRlcmVkUGVvcGxlIiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiZ2F0aGVyVXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiZGVzYyIsImFkZFByb2plY3QiLCJjbGVhcklucHV0cyIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwicmVuZGVyQ29udGVudCIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiX2V2ZW50IiwiY29uc29sZSIsImxvZyIsImRyYWdTdGFydEhhbmRsZXIiLCJkcmFnRW5kSGFuZGxlciIsInRleHRDb250ZW50IiwicGVyc29ucyIsIlByb2plY3RMaXN0IiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsIkZpbmlzaGVkIiwicmVtb3ZlIiwiZHJhZ092ZXJIYW5kbGVyIiwiZHJhZ0xlYXZlSGFuZGxlciIsImRyb3BIYW5kbGVyIiwiYWRkTGlzdGVuZXIiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicHJqIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iXSwibWFwcGluZ3MiOiJtQkFBTyxTQUFTQSxFQUFTQyxFQUFRQyxFQUFZQyxHQUN6QyxNQUFNQyxFQUFpQkQsRUFBV0UsTUFRbEMsTUFQMEMsQ0FDdENDLGNBQWMsRUFDZCxNQUVJLE9BRGdCRixFQUFlRyxLQUFLQyxRQ0poRCxJQUFZQyxHQUFaLFNBQVlBLEdBQ1IsdUJBQ0EsMkJBRkosQ0FBWUEsTUFBYSxLQUtsQixNQUFPQyxFQUNWLFlBQ1dDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBSkEsS0FBQUosS0FDQSxLQUFBQyxRQUNBLEtBQUFDLGNBQ0EsS0FBQUMsU0FDQSxLQUFBQyxVQ0RKLE1BQU1DLFVBUGIsb0JBQ2MsS0FBQUMsVUFBMkIsR0FDckMsWUFBWUMsR0FDUlYsS0FBS1MsVUFBVUUsS0FBS0QsS0FReEIsY0FDSUUsUUFKSSxLQUFBQyxTQUFzQixHQU85QixxQkFDSSxPQUFJYixLQUFLYyxXQUdUZCxLQUFLYyxTQUFXLElBQUlOLEdBRlRSLEtBQUtjLFNBTXBCLFdBQVdWLEVBQWVDLEVBQXFCVSxHQUMzQyxNQUFNQyxFQUFhLElBQUlkLEVBQ25CZSxLQUFLQyxTQUFTQyxXQUNkZixFQUNBQyxFQUNBVSxFQUNBZCxFQUFjbUIsUUFFbEJw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dW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gYXV0b2JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgY29uc3QgYWRqRGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIGJvdW5kRm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBhZGpEZXNjcmlwdG9yO1xufVxuIiwiXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcbiAgICBBY3RpdmUsXG4gICAgRmluaXNoZWRcbn1cbiAgXG5leHBvcnQgIGNsYXNzIFByb2plY3Qge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcbiAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcbiAgICApIHt9XG4gIH0iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XG5cbiAgICB0eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XG5cbiAgICBjbGFzcyBTdGF0ZTxUPiB7XG4gICAgICAgIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcbiAgICAgICAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBleHBvcnQgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD4ge1xuICAgICAgICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcbiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcblxuICAgICAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIG51bU9mUGVvcGxlOiBudW1iZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcbiAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgbnVtT2ZQZW9wbGUsXG4gICAgICAgICAgICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XG4gICAgICAgICAgICB0aGlzLnVwZGFlTGlzdGVuZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByb2plY3QgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9qZWN0LmlkID09PSBwcm9qZWN0SWQ7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZihwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGFlTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBwcml2YXRlIHVwZGFlTGlzdGVuZXJzKCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdGVuZXJzKSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKTsiLCIgICAgZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XG4gICAgICAgIHZhbHVlOiBzdHJpbmcgfCBudW1iZXI7XG4gICAgICAgIHJlcXVpcmVkPzogYm9vbGVhbjtcbiAgICAgICAgbWluTGVuZ3RoPzogbnVtYmVyO1xuICAgICAgICBtYXhMZW5ndGg/OiBudW1iZXI7XG4gICAgICAgIG1pbj86IG51bWJlcjtcbiAgICAgICAgbWF4PzogbnVtYmVyO1xuICAgIH1cbiAgXG4gICAgZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKSB7XG4gICAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQucmVxdWlyZWQpIHtcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICE9PSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgICApIHtcbiAgICAgICAgICAgIGlzVmFsaWQgPVxuICAgICAgICAgICAgICAgIGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPj0gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJlxuICAgICAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdzdHJpbmcnXG4gICAgICAgICkge1xuICAgICAgICAgICAgaXNWYWxpZCA9XG4gICAgICAgICAgICAgICAgaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXG4gICAgICAgICAgICB2YWxpZGF0YWJsZUlucHV0Lm1pbiAhPSBudWxsICYmXG4gICAgICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcidcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnbnVtYmVyJ1xuICAgICAgICApIHtcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzVmFsaWQ7XG4gICAgfSIsImV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcbiAgICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgaG9zdEVsZW1lbnQ6IFQ7XG4gICAgZWxlbWVudDogVTtcbiAgXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHRlbXBsYXRlSWQ6IHN0cmluZyxcbiAgICAgICAgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxuICAgICAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxuICAgICAgICBuZXdFbGVtZW50SWQ/OiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgICAgICAgICAgIHRlbXBsYXRlSWRcbiAgICAgICAgKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuICBcbiAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQuY29udGVudCxcbiAgICAgICAgdHJ1ZVxuICAgICAgICApO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICAgICAgaWYgKG5ld0VsZW1lbnRJZCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkO1xuICAgICAgICB9XG4gIFxuICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcbiAgICB9XG4gIFxuICAgIHByaXZhdGUgYXR0YWNoKGluc2VydEF0QmVnaW5uaW5nOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxuICAgICAgICAgICAgaW5zZXJ0QXRCZWdpbm5pbmcgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJyxcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudFxuICAgICAgICApO1xuICAgIH1cbiAgXG4gICAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XG4gICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xufVxuIiwiaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcbmltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gXCIuLi91dGlsL3ZhbGlkYXRpb25cIjtcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5cblxuICAgIGV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xuICAgICAgICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHBlb3BsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgICBcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpO1xuICAgICAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJyN0aXRsZSdcbiAgICAgICAgICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICcjZGVzY3JpcHRpb24nXG4gICAgICAgICAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJyNwZW9wbGUnXG4gICAgICAgICAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIHJlbmRlckNvbnRlbnQoKSB7fVxuICAgIFxuICAgICAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcbiAgICAgICAgICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgICAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIFxuICAgICAgICAgICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgbWluTGVuZ3RoOiA1XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiArZW50ZXJlZFBlb3BsZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBtaW46IDEsXG4gICAgICAgICAgICAgICAgbWF4OiA1XG4gICAgICAgICAgICB9O1xuICAgIFxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgIXZhbGlkYXRlKHRpdGxlVmFsaWRhdGFibGUpIHx8XG4gICAgICAgICAgICAhdmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHxcbiAgICAgICAgICAgICF2YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KCdJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsIGVudGVyZWREZXNjcmlwdGlvbiwgK2VudGVyZWRQZW9wbGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgXG4gICAgICAgIHByaXZhdGUgY2xlYXJJbnB1dHMoKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIEBhdXRvYmluZFxuICAgICAgICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VySW5wdXQ7XG4gICAgICAgICAgICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2MsIHBlb3BsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFxuXG4gICAgXG4gICAgICAiLCJpbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcblxuXG4gICAgZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+XG4gICAgaW1wbGVtZW50cyBEcmFnZ2FibGUge1xuICAgICAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XG4gICAgICAgIGdldCBwZXJzb25zKCkge1xuICAgICAgICAgICAgaWYodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgMSBwZXJzb25gXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcbiAgICAgICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBAYXV0b2JpbmRcbiAgICAgICAgZHJhZ1N0YXJ0SGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xuICAgICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xuICAgICAgICB9XG4gICAgICAgIGRyYWdFbmRIYW5kbGVyKF9ldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRHJhZ0VuZCcpXG4gICAgICAgIH1cblxuICAgICAgICBjb25maWd1cmUoKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XG4gICAgICAgIH1cblxuICAgICAgICByZW5kZXJDb250ZW50KCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZC4nO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XG4gICAgICAgIH1cbiAgICB9XG4iLCJpbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcbmltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlXCI7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcblxuICAgIGV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+XG4gICAgaW1wbGVtZW50cyBEcmFnVGFyZ2V0IHtcbiAgICAgICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XG4gICAgICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xuICAgICAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG5cbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIEBhdXRvYmluZFxuICAgICAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICAgICAgaWYoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgICAgICAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgQGF1dG9iaW5kXG4gICAgICAgIGRyb3BIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RJZCA9IGV2ZW50LmRhdGFUcmFuc2ZlciEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuICAgICAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByb2plY3RJZCwgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZCk7XG4gICAgICAgIH1cblxuICAgICAgICBAYXV0b2JpbmRcbiAgICAgICAgZHJhZ0xlYXZlSGFuZGxlcihfZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xuICAgICAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpXG4gICAgICAgIH1cblxuICAgICAgICBjb25maWd1cmUoKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XG5cbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbGV2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIocHJqID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5GaW5pc2hlZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVuZGVyQ29udGVudCgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgIHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJyBQUk9KRUNUUyc7XG4gICAgICAgIH1cblxuICAgICAgICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICAgICAgICAgICAgYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YFxuICAgICAgICAgICAgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcbiAgICAgICAgICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIGZvciAoY29uc3QgcHJqSXRlbSBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdHMpIHtcbiAgICAgICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuIiwiaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSBcIi4vY29tcG9uZW50cy9wcm9qZWN0LWlucHV0XCI7XG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XG5cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJyk7XG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XG5cbmNvbnNvbGUubG9nKCdjY2MnKVxuXG4gICJdLCJzb3VyY2VSb290IjoiIn0=